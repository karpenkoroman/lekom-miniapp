<!doctype html>
<html lang="ru">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1"/>
<title>–õ–ï–ö–û–ú ¬∑ –ê—É–¥–∏—Ç –ø–µ—á–∞—Ç–∏</title>
<script src="https://telegram.org/js/telegram-web-app.js"></script>
<style>
  :root { --gap:14px; --radius:12px; --muted:#6b7280; }
  body{font-family:system-ui,-apple-system,Segoe UI,Roboto,Inter,Arial,sans-serif;margin:0;background:var(--tg-theme-secondary-bg-color,#f6f7fb);color:var(--tg-theme-text-color,#111)}
  .wrap{max-width:900px;margin:0 auto;padding:20px}
  .card{background:var(--tg-theme-bg-color,#fff);border-radius:16px;box-shadow:0 6px 24px rgba(0,0,0,.06);padding:20px}
  h1{margin:0 0 6px;font-size:22px}
  .sub{color:var(--muted);margin-bottom:8px}
  .meta{font-size:13px;color:var(--muted);margin-bottom:12px}
  .q{border:1px solid rgba(0,0,0,.08);border-radius:12px;padding:14px;margin:12px 0;background:var(--tg-theme-secondary-bg-color,#f8f8f9)}
  .q legend{font-weight:700;margin-bottom:8px}
  .opt{display:flex;gap:10px;align-items:flex-start;margin:8px 0}
  .opt input{margin-top:2px}
  .progress{height:8px;background:#e5e7eb;border-radius:6px;overflow:hidden;margin:10px 0}
  .bar{height:100%;width:0;background:var(--tg-theme-button-color,#0a84ff);transition:width .25s}
  .hint{font-size:12px;color:var(--muted)}
  /* –†–µ–∑—É–ª—å—Ç–∞—Ç */
  .result{display:none;margin-top:16px;padding:16px;border-left:4px solid var(--tg-theme-button-color,#0a84ff);background:rgba(10,132,255,.08);border-radius:10px}
  .result h3{margin:0 0 6px;font-size:18px}
  .ctas{display:flex;gap:10px;flex-wrap:wrap;margin-top:12px}
  .cta{display:inline-block;text-decoration:none;padding:12px 14px;border-radius:10px;font-weight:700}
  .cta.primary{background:var(--tg-theme-button-color,#0a84ff);color:var(--tg-theme-button-text-color,#fff)}
  .cta.secondary{background:#eef1f5;color:#111}
</style>
</head>
<body>
<div class="wrap">
  <div class="card">
    <h1>–ê—É–¥–∏—Ç –ø–µ—á–∞—Ç–Ω–æ–π –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä—ã</h1>
    <div class="sub">–ù–µ—É–¥–æ–±–Ω—ã–µ –≤–æ–ø—Ä–æ—Å—ã, –∫–æ—Ç–æ—Ä—ã–µ IT-–¥–∏—Ä–µ–∫—Ç–æ—Ä –¥–æ–ª–∂–µ–Ω –∑–∞–¥–∞—Ç—å —Å–∞–º —Å–µ–±–µ</div>
    <div class="meta">‚è± ~5 –º–∏–Ω—É—Ç ¬∑ –û—Ç–≤–µ—Ç—ã –∫–æ–Ω—Ñ–∏–¥–µ–Ω—Ü–∏–∞–ª—å–Ω—ã</div>

    <div class="progress"><div id="bar" class="bar"></div></div>
    <div id="pc" class="hint">0/11</div>

    <form id="f">
      <!-- 1‚Äì11 -->
      <fieldset class="q"><legend>1. –ü—Ä–æ–∑—Ä–∞—á–Ω–æ—Å—Ç—å —É—á—ë—Ç–∞ —Ä–∞—Å—Ö–æ–¥–æ–≤?</legend>
        <label class="opt"><input type="radio" name="q1" value="1">–ü–æ–ª–Ω—ã–π –∏ —Ç–æ—á–Ω—ã–π —É—á—ë—Ç –≤—Å–µ—Ö —Ä–∞—Å—Ö–æ–¥–æ–≤</label>
        <label class="opt"><input type="radio" name="q1" value="0">–¢–æ–ª—å–∫–æ —Ä–∞—Å—Ö–æ–¥–Ω—ã–µ –º–∞—Ç–µ—Ä–∏–∞–ª—ã</label>
        <label class="opt"><input type="radio" name="q1" value="0">–ß–∞—Å—Ç–∏—á–Ω–æ/–ø–æ-—Ä–∞–∑–Ω–æ–º—É</label>
        <label class="opt"><input type="radio" name="q1" value="0">¬´–ù–∞ –≥–ª–∞–∑¬ª</label>
      </fieldset>

      <fieldset class="q"><legend>2. –ö–∞–ø–∑–∞—Ç—Ä–∞—Ç—ã (–∞–º–æ—Ä—Ç–∏–∑–∞—Ü–∏—è/–æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ) —É—á–∏—Ç—ã–≤–∞–µ—Ç–µ?</legend>
        <label class="opt"><input type="radio" name="q2" value="1">–î–∞, —Å—á–∏—Ç–∞–µ–º TCO</label>
        <label class="opt"><input type="radio" name="q2" value="0">–ß–∞—Å—Ç–∏—á–Ω–æ</label>
        <label class="opt"><input type="radio" name="q2" value="0">–ù–µ—Ç, —Ç–æ–ª—å–∫–æ —Ç–µ–∫—É—â–∏–µ</label>
        <label class="opt"><input type="radio" name="q2" value="0">–ù–µ –∑–Ω–∞—é/–¥—Ä—É–≥–æ–π –æ—Ç–¥–µ–ª</label>
      </fieldset>

      <fieldset class="q"><legend>3. –ù–∞ —á—ë–º –æ—Å–Ω–æ–≤–∞–Ω –±—é–¥–∂–µ—Ç?</legend>
        <label class="opt"><input type="radio" name="q3" value="1">–ê–∫—Ç—É–∞–ª—å–Ω—ã–µ —Ä—ã–Ω–æ—á–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ</label>
        <label class="opt"><input type="radio" name="q3" value="0">–ü—Ä–æ—à–ª—ã–µ –≥–æ–¥—ã</label>
        <label class="opt"><input type="radio" name="q3" value="0">–°—É–±—ä–µ–∫—Ç–∏–≤–Ω—ã–µ –æ–∂–∏–¥–∞–Ω–∏—è</label>
        <label class="opt"><input type="radio" name="q3" value="0">–ù–µ—Ç –æ—Ç–¥–µ–ª—å–Ω–æ–≥–æ –±—é–¥–∂–µ—Ç–∞</label>
      </fieldset>

      <fieldset class="q"><legend>4. –ü—Ä–æ–≤–µ—Ä—è–ª–∏ —Ü–µ–Ω—ã –∑–∞ 12 –º–µ—Å.?</legend>
        <label class="opt"><input type="radio" name="q4" value="1">–î–∞, —Ä–µ–≥—É–ª—è—Ä–Ω–æ</label>
        <label class="opt"><input type="radio" name="q4" value="0">–î–∞–≤–Ω–µ–Ω—å–∫–æ</label>
        <label class="opt"><input type="radio" name="q4" value="0">–ù–µ—Ç</label>
        <label class="opt"><input type="radio" name="q4" value="0">–ù–µ –∑–Ω–∞—é</label>
      </fieldset>

      <fieldset class="q"><legend>5. –†–µ–µ—Å—Ç—Ä—ã (–ü–ü ‚Ññ185, ‚Ññ878) —É—á—Ç–µ–Ω—ã?</legend>
        <label class="opt"><input type="radio" name="q5" value="1">–î–∞, –ø–æ–ª–Ω–æ—Å—Ç—å—é</label>
        <label class="opt"><input type="radio" name="q5" value="0">–ß–∞—Å—Ç–∏—á–Ω–æ</label>
        <label class="opt"><input type="radio" name="q5" value="0">–ù–µ—Ç</label>
        <label class="opt"><input type="radio" name="q5" value="1">–ù–µ –ø—Ä–∏–º–µ–Ω–∏–º–æ</label>
      </fieldset>

      <fieldset class="q"><legend>6. –ì–æ—Ç–æ–≤–Ω–æ—Å—Ç—å –∫ —Ä–æ—Å—Ç—É —Ü–µ–Ω 3‚Äì5√ó –∏–∑-–∑–∞ —Ä–µ–≥—É–ª—è—Ç–æ—Ä–∏–∫–∏?</legend>
        <label class="opt"><input type="radio" name="q6" value="1">–î–∞, –∑–∞–ª–æ–∂–µ–Ω —Ä–µ–∑–µ—Ä–≤</label>
        <label class="opt"><input type="radio" name="q6" value="0">–ù–µ—Ç, –±—É–¥–µ—Ç –ø—Ä–æ–±–ª–µ–º–æ–π</label>
        <label class="opt"><input type="radio" name="q6" value="0">–ù–µ –∞–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞–ª–∏</label>
        <label class="opt"><input type="radio" name="q6" value="0">–ù–µ –∑–Ω–∞—é</label>
      </fieldset>

      <fieldset class="q"><legend>7. –ö—Ç–æ –ø—Ä–∏–Ω–∏–º–∞–µ—Ç —Ä–µ—à–µ–Ω–∏—è –ø–æ –ø–µ—á–∞—Ç–∏?</legend>
        <label class="opt"><input type="radio" name="q7" value="1">IT-–¥–∏—Ä–µ–∫—Ç–æ—Ä/—Ä—É–∫–æ–≤–æ–¥–∏—Ç–µ–ª—å</label>
        <label class="opt"><input type="radio" name="q7" value="0">–°–∏—Å–∞–¥–º–∏–Ω/–∏–Ω–∂–µ–Ω–µ—Ä</label>
        <label class="opt"><input type="radio" name="q7" value="0">–ó–∞–∫—É–ø–∫–∏</label>
        <label class="opt"><input type="radio" name="q7" value="0">–ù–µ—Å–∫–æ–ª—å–∫–æ –ª–∏—Ü –±–µ–∑ –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç–∏</label>
      </fieldset>

      <fieldset class="q"><legend>8. –ù–∞ —á—ë–º –æ—Å–Ω–æ–≤–∞–Ω–∞ —ç–∫—Å–ø–ª—É–∞—Ç–∞—Ü–∏—è?</legend>
        <label class="opt"><input type="radio" name="q8" value="1">–î–∞–Ω–Ω—ã–µ –∏ –º–µ—Ç—Ä–∏–∫–∏ (TCO, SLA)</label>
        <label class="opt"><input type="radio" name="q8" value="0">¬´–í—Å–µ–≥–¥–∞ —Ç–∞–∫ –¥–µ–ª–∞–ª–∏¬ª</label>
        <label class="opt"><input type="radio" name="q8" value="0">–°–æ–≤–µ—Ç—ã –ø–æ—Å—Ç–∞–≤—â–∏–∫–æ–≤</label>
        <label class="opt"><input type="radio" name="q8" value="0">–≠–∫–æ–Ω–æ–º–∏—è ¬´–∑–¥–µ—Å—å –∏ —Å–µ–π—á–∞—Å¬ª</label>
      </fieldset>

      <fieldset class="q"><legend>9. –°–æ–≤–º–µ—Å—Ç–∏–º—ã–µ –∫–∞—Ä—Ç—Ä–∏–¥–∂–∏/–∑–∞–ø—Ä–∞–≤–∫–∞?</legend>
        <label class="opt"><input type="radio" name="q9" value="1">–ù–µ—Ç, —Ç–æ–ª—å–∫–æ –æ—Ä–∏–≥–∏–Ω–∞–ª—ã</label>
        <label class="opt"><input type="radio" name="q9" value="0">–î–∞, –º–∞—Å—Å–æ–≤–æ</label>
        <label class="opt"><input type="radio" name="q9" value="0">–î–∞, —á–∞—Å—Ç–∏—á–Ω–æ</label>
        <label class="opt"><input type="radio" name="q9" value="0">–ù–µ –∑–Ω–∞—é</label>
      </fieldset>

      <fieldset class="q"><legend>10. –£—Ä–æ–≤–µ–Ω—å –∑—Ä–µ–ª–æ—Å—Ç–∏?</legend>
        <label class="opt"><input type="radio" name="q10" value="1">–°—Ç—Ä–∞—Ç–µ–≥–∏—á–µ—Å–∫–∏–π ‚Äî –ø–æ–ª–∏—Ç–∏–∫–∞, –º–µ—Ç—Ä–∏–∫–∏, –±—é–¥–∂–µ—Ç</label>
        <label class="opt"><input type="radio" name="q10" value="0">–¢–∞–∫—Ç–∏—á–µ—Å–∫–∏–π</label>
        <label class="opt"><input type="radio" name="q10" value="0">–†–µ–∞–∫—Ç–∏–≤–Ω—ã–π</label>
        <label class="opt"><input type="radio" name="q10" value="0">–°—Ç–∏—Ö–∏–π–Ω–æ/–Ω–µ—Ç —Å–∏—Å—Ç–µ–º—ã</label>
      </fieldset>

      <fieldset class="q"><legend>11. –ë—é–¥–∂–µ—Ç –±–µ–∑ ¬´—Å–ª–µ–ø—ã—Ö –∑–æ–Ω¬ª?</legend>
        <label class="opt"><input type="radio" name="q11" value="1">–ü–æ–ª–Ω–æ—Å—Ç—å—é —É–≤–µ—Ä–µ–Ω</label>
        <label class="opt"><input type="radio" name="q11" value="0">–°–∫–æ—Ä–µ–µ —É–≤–µ—Ä–µ–Ω</label>
        <label class="opt"><input type="radio" name="q11" value="0">–ï—Å—Ç—å —Å–æ–º–Ω–µ–Ω–∏—è</label>
        <label class="opt"><input type="radio" name="q11" value="0">–¢—Ä–µ–±—É–µ—Ç –ø–µ—Ä–µ—Å–º–æ—Ç—Ä–∞</label>
      </fieldset>
    </form>

    <!-- –†–µ–∑—É–ª—å—Ç–∞—Ç –∏ CTA -->
    <div id="res" class="result">
      <h3 id="resTitle">–í–∞—à —Ä–µ–∑—É–ª—å—Ç–∞—Ç</h3>
      <div id="resText" class="hint"></div>
      <div class="ctas">
        <a id="ctaDiscuss" class="cta primary" target="_blank" rel="noopener">üí¨ –û–±—Å—É–¥–∏—Ç—å —Å —ç–∫—Å–ø–µ—Ä—Ç–æ–º</a>
        <a id="ctaContact" class="cta secondary" target="_blank" rel="noopener">üì© –û—Å—Ç–∞–≤–∏—Ç—å –∫–æ–Ω—Ç–∞–∫—Ç—ã</a>
      </div>
    </div>

    <div class="hint" style="margin-top:10px">–ù–∞–∂–º–∏—Ç–µ ¬´–û—Ç–ø—Ä–∞–≤–∏—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç¬ª –≤–Ω–∏–∑—É, –∫–æ–≥–¥–∞ –∑–∞–∫–æ–Ω—á–∏—Ç–µ.</div>
  </div>
</div>

<script>
  const tg = window.Telegram?.WebApp;
  if (tg) tg.ready();

  // –ü–∞—Ä–∞–º–µ—Ç—Ä—ã URL
  const params = new URLSearchParams(location.search);
  const GAS_HOOK   = params.get('hook');     // URL Apps Script (–º–æ–∂–Ω–æ –∑–∞–∫–æ–¥–∏—Ä–æ–≤–∞–Ω–Ω—ã–π)
  const CONTACT_URL= params.get('contact') || 'https://lekom.ru/contacts'; // –º–µ–Ω—è–π –Ω–∞ —Å–≤–æ—é —Ñ–æ—Ä–º—É
  const DISCUSS_URL= 'https://t.me/romankarpenko';

  // –°—Å—ã–ª–∫–∏ CTA
  document.getElementById('ctaDiscuss').href = DISCUSS_URL;
  document.getElementById('ctaContact').href = CONTACT_URL;

  // –ü—Ä–æ–≥—Ä–µ—Å—Å
  const total = 11;
  const names = Array.from({length: total}, (_,i)=>'q'+(i+1));
  const f = document.getElementById('f');
  const bar = document.getElementById('bar');
  const pc = document.getElementById('pc');

  function answeredCount(){
    return names.reduce((a,n)=> a + (f.querySelector(`input[name="${n}"]:checked`)?1:0), 0);
  }
  function updateUI(){
    const done = answeredCount();
    bar.style.width = Math.round(done/total*100) + '%';
    pc.textContent = `${done}/${total}`;
    if (tg) {
      if(done===total) { tg.MainButton.setText('–û—Ç–ø—Ä–∞–≤–∏—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç').show(); }
      else { tg.MainButton.hide(); }
    }
  }

  if (tg) tg.onEvent('mainButtonClicked', submit);
  f.addEventListener('change', updateUI);
  updateUI();

  async function submit(){
    let score=0, answers={};
    names.forEach(n=>{
      const el=f.querySelector(`input[name="${n}"]:checked`);
      const val = Number(el?.value||0);
      answers[n]=val;
      if(val===1) score+=1;
    });

    let verdict, advice, icon;
    if(score>=8){ icon='‚≠êÔ∏è'; verdict='–ó—Ä–µ–ª–∞—è –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–∞'; advice='–¢–æ—á–µ—á–Ω—ã–π –∞—É–¥–∏—Ç TCO –∏ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è ¬´–¥–ª–∏–Ω–Ω–æ–≥–æ —Ö–≤–æ—Å—Ç–∞¬ª.'; }
    else if(score>=5){ icon='‚ö†Ô∏è'; verdict='–ö–æ–Ω—Ç—Ä–æ–ª—å —á–∞—Å—Ç–∏—á–Ω—ã–π'; advice='–ü–µ—Ä–µ—Å–º–æ—Ç—Ä –±—é–¥–∂–µ—Ç–∞, —É–Ω–∏—Ñ–∏–∫–∞—Ü–∏—è –ø–æ–ª–∏—Ç–∏–∫–∏ –∏ KPI (TCO, SLA).'; }
    else { icon='‚ùóÔ∏è'; verdict='–í—ã—Å–æ–∫–∞—è —É—è–∑–≤–∏–º–æ—Å—Ç—å'; advice='–≠–∫—Å–ø—Ä–µ—Å—Å-–∞—É–¥–∏—Ç, –∏–Ω–≤–µ–Ω—Ç–∞—Ä–∏–∑–∞—Ü–∏—è, –±—ã—Å—Ç—Ä—ã–µ –º–µ—Ä—ã —ç–∫–æ–Ω–æ–º–∏–∏.'; }

    const payload = {
      score, verdict, advice, answers,
      t: new Date().toISOString(),
      initData: tg?.initDataUnsafe || null
    };
    const body = JSON.stringify(payload);

    // 1) –≤ Google (–µ—Å–ª–∏ hook –∑–∞–¥–∞–Ω)
    if (GAS_HOOK) {
      try {
        // sendBeacon —Å–Ω–∞—á–∞–ª–∞ (–Ω–µ –±–ª–æ–∫–∏—Ä—É–µ—Ç –∑–∞–∫—Ä—ã—Ç–∏–µ –≤–µ–±-–≤—å—é), –ø–æ—Ç–æ–º fetch –Ω–∞ –≤—Å—è–∫–∏–π
        let ok = false;
        if (navigator.sendBeacon) ok = navigator.sendBeacon(GAS_HOOK, new Blob([body], {type:'application/json'}));
        if (!ok) await fetch(GAS_HOOK, {method:'POST', headers:{'content-type':'application/json'}, body});
      } catch(e){}
    }

    // 2) –±–æ—Ç—É
    try { tg && tg.sendData(body); } catch(e){}

    // 3) –ø–æ–∫–∞–∑–∞—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç –∏ CTA –≤ –º–∏–Ω–∏-–∞–ø–ø–µ
    document.getElementById('resTitle').textContent = `–í–∞—à —Ä–µ–∑—É–ª—å—Ç–∞—Ç: ${icon} ${score}/11 ‚Äî ${verdict}`;
    document.getElementById('resText').textContent  = advice;
    document.getElementById('res').style.display = 'block';

    // –ö–Ω–æ–ø–∫–∞ –≤–Ω–∏–∑—É ‚Üí ¬´–ó–∞–∫—Ä—ã—Ç—å¬ª
    if (tg) {
      tg.MainButton.setText('–ó–∞–∫—Ä—ã—Ç—å').show();
      tg.offEvent('mainButtonClicked', submit);
      tg.onEvent('mainButtonClicked', () => tg.close());
    }
    // –°–∫—Ä–æ–ª–ª–∏–º –∫ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—É
    document.getElementById('res').scrollIntoView({behavior:'smooth', block:'start'});
  }
</script>
</body>
</html>
