<!doctype html>
<html lang="ru">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover" />
  <title>ЛЕКОМ · мини-приложение</title>

  <!-- Ранняя установка темы (без «мигания») -->
  <script>
    (function(){
      const saved = localStorage.getItem('theme');
      const prefersLight = window.matchMedia?.('(prefers-color-scheme: light)').matches;
      const theme = saved || (prefersLight ? 'light' : 'dark');
      if (theme === 'light') document.documentElement.classList.add('theme-light');
      document.documentElement.setAttribute('data-theme', theme);
    })();
  </script>

  <style>
  @import url('https://fonts.googleapis.com/css2?family=Roboto:wght@400;500;700&display=swap');

  /* Тёмная тема по умолчанию */
  :root{
    --bg:#0e1015; --bg2:#171b25; --stroke:#293044;
    --text:#eaf0fa; --text-dim:#96a2c2;
    --brand:#2a7de1; --brand2:#1db8aa;
    --radius:16px;
    --pill:#101625; --pill-hover:#141b2b; --pill-selected:rgba(29,184,170,.22); --pill-outline:rgba(29,184,170,.5);
    --shadow:0 10px 30px rgba(0,0,0,.25);
    --result-bg:#0f1623; --result-stroke:#22314d; --bar-bg:#101625;
  }
  /* Светлая тема перекрытия */
  html.theme-light{
    --bg:#f6f8fb; --bg2:#ffffff; --stroke:#e2e8f0;
    --text:#0f172a; --text-dim:#4b5563;
    --brand:#2a7de1; --brand2:#10b3a3;
    --pill:#ffffff; --pill-hover:#f3f7fb; --pill-selected:rgba(16,179,163,.14); --pill-outline:rgba(16,179,163,.45);
    --shadow:0 8px 24px rgba(15,23,42,.08);
    --result-bg:#ffffff; --result-stroke:#d7e0ef; --bar-bg:#edf2f7;
  }

  html,body{
    margin:0; padding:0; background:var(--bg); color:var(--text);
    font-family:Roboto,system-ui,-apple-system,Segoe UI,Arial,sans-serif;
    -webkit-font-smoothing:antialiased; text-rendering:optimizeLegibility;
  }
  .app{max-width:720px;margin:0 auto;padding:16px 16px 28px;box-sizing:border-box;}

  /* Шапка: логотип + переключатель темы */
  .topbar{display:flex;align-items:center;justify-content:space-between;gap:12px;margin-bottom:8px;}
  .logo-bar{display:flex;align-items:center;justify-content:flex-start;padding:2px 0 6px;}
  .logo-bar img{height:40px;max-width:200px;object-fit:contain;display:none}

  .theme-toggle{
    display:inline-flex;align-items:center;gap:8px;padding:10px 12px;border-radius:12px;
    background:var(--bg2);border:1px solid var(--stroke);cursor:pointer;user-select:none;
  }
  .theme-toggle svg{width:18px;height:18px}
  .theme-label{font-weight:600;font-size:14px;color:var(--text-dim);}

  /* Карточки и типографика */
  .card{background:var(--bg2);border:1px solid var(--stroke);border-radius:var(--radius);padding:16px;box-shadow:var(--shadow)}
  h1{font-size:26px;margin:0 0 12px} h2{font-size:22px;margin:0 0 10px} h3{font-size:18px;margin:0 0 8px}
  .muted{color:var(--text-dim)}
  .section + .section{margin-top:16px}
  hr{border:0;height:1px;background:var(--stroke);opacity:.6;margin:14px 0}

  /* Кнопки */
  .btn{
    display:inline-flex;align-items:center;justify-content:center;gap:8px;
    width:100%;min-height:46px;padding:12px 16px;
    font-size:16px;font-weight:700;line-height:1.15;letter-spacing:.2px;
    border-radius:12px;border:1px solid transparent;cursor:pointer;
    transition:filter .12s,transform .06s ease;user-select:none;-webkit-tap-highlight-color:transparent;
    text-align:center;flex-direction:column;box-sizing:border-box;
  }
  .btn-sub{display:block;font-weight:600;font-size:13px;opacity:.9;margin-top:2px}
  .btn:active{transform:translateY(1px)}
  .btn:disabled{opacity:.6;cursor:not-allowed;transform:none}
  .btn + .btn{margin-top:10px}
  .btn-primary{color:#fff;background:linear-gradient(135deg,var(--brand),var(--brand2));box-shadow:0 10px 28px rgba(42,125,225,.18)}
  .btn-primary:hover{filter:brightness(1.06)}
  .btn-secondary{color:var(--text);background:var(--bg2);border:1px solid var(--stroke)}
  .btn-secondary:hover{filter:brightness(1.03)}
  .btn-row{display:flex;gap:12px;flex-wrap:wrap}
  .btn-row .btn{flex:1 1 220px}

  /* Плашки ответов */
  .q{margin-top:18px}
  .q b{display:block;margin-bottom:10px;font-size:17px}
  .pill{
    display:block;width:100%;text-align:left;font-size:16px;line-height:1.45;
    padding:14px 16px;margin-top:8px;border-radius:12px;border:1px solid var(--stroke);
    background:var(--pill);color:var(--text);cursor:pointer;box-sizing:border-box;
    word-break:break-word;overflow-wrap:anywhere;
  }
  .pill:hover{background:var(--pill-hover)}
  .pill.selected{background:var(--pill-selected);border-color:var(--brand2);outline:2px solid var(--pill-outline)}

  /* Результат */
  #auditProgress{margin:6px 0 12px;font-size:14px;color:var(--text-dim)}
  #resultBox{margin-top:16px}
  .result-card{background:var(--result-bg);border:1px solid var(--result-stroke);border-radius:16px;padding:16px;box-shadow:var(--shadow)}
  .result-score{font-size:22px;font-weight:800;text-align:center;margin-bottom:6px}
  .result-hint{margin-top:6px;color:var(--text-dim);text-align:center}
  #resultBox .cta-row{display:flex;gap:12px;flex-wrap:wrap;margin-top:12px}
  #resultBox .btn{flex:1 1 220px}

  /* Сводка голосования */
  .summary-row{margin:8px 0}
  .summary-head{display:flex;justify-content:space-between;gap:8px}
  .summary-bar{height:8px;background:var(--bar-bg);border:1px solid var(--stroke);border-radius:999px;overflow:hidden}
  .summary-fill{height:100%;background:linear-gradient(90deg,var(--brand),var(--brand2))}

  /* Тост */
  .toast-overlay{position:fixed;inset:0;background:rgba(0,0,0,.45);display:none;align-items:center;justify-content:center;z-index:9999}
  .toast-box{background:var(--bg2);border:1px solid var(--stroke);padding:20px;border-radius:14px;max-width:320px;width:calc(100vw - 48px);text-align:center;line-height:1.5;box-shadow:var(--shadow)}
  .toast-box .btn{width:100%;margin-top:10px}

  /* Футер */
  .footer{margin-top:24px;padding-top:12px;border-top:1px solid var(--stroke);text-align:center;font-size:14px;color:var(--text-dim)}
  .footer a{color:var(--brand2);text-decoration:none;font-weight:500}
  .footer a:hover{text-decoration:underline}
  .footer-icons{display:flex;justify-content:center;gap:14px;margin-bottom:6px}
  .footer-icons svg{width:22px;height:22px}
  </style>

  <!-- Актуальный EXEC-hook -->
  <script>
    window.LEKOM_HOOK='https://script.google.com/macros/s/AKfycbzUnezeA6Pu2-ol6UVUkZpqfBIpEyji09dMGbkk6m4-Iu2-3-KwxZkLTrkoHGHRcIqN/exec';
  </script>
</head>
<body>
  <div class="app">

    <!-- Топбар: логотип + переключатель темы -->
    <div class="topbar">
      <div class="logo-bar">
        <!-- логотипы из GitHub -->
        <img id="logoDark"  src="https://raw.githubusercontent.com/karpenkoroman/lekom-miniapp/main/img/logo-dark.png"  alt="ЛЕКОМ" />
        <img id="logoLight" src="https://raw.githubusercontent.com/karpenkoroman/lekom-miniapp/main/img/logo-light.png" alt="ЛЕКОМ" />
      </div>
      <button id="themeToggle" class="theme-toggle" type="button" aria-label="Сменить тему">
        <svg id="iconMoon" viewBox="0 0 24 24" fill="none"><path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79Z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/></svg>
        <svg id="iconSun" viewBox="0 0 24 24" fill="none" style="display:none"><circle cx="12" cy="12" r="5" stroke="currentColor" stroke-width="2"/><path d="M12 1v3m0 16v3M4.22 4.22 6.34 6.34m11.32 11.32 2.12 2.12M1 12h3m16 0h3M4.22 19.78 6.34 17.66m11.32-11.32 2.12-2.12" stroke="currentColor" stroke-width="2" stroke-linecap="round"/></svg>
        <span class="theme-label" id="themeLabel">Тёмная</span>
      </button>
    </div>

    <!-- стартовый экран -->
    <div id="screen-start" class="card section">
      <div class="btn-row">
        <button id="goAudit" class="btn btn-primary">
          Пройдите быстрый аудит печати
          <span class="btn-sub">выявите слабые места в&nbsp;управлении печатной инфраструктурой</span>
        </button>
        <button id="goPoll" class="btn btn-secondary">Выберите тему вебинара</button>
      </div>

      <hr>

      <h3>Сводка голосования по темам</h3>
      <div id="summaryContent"><div class="muted">Загрузка…</div></div>

      <!-- футер -->
      <div class="footer">
        <div class="footer-icons">
          <!-- Telegram -->
          <a href="https://lekomIT.t.me" target="_blank" title="Telegram">
            <svg viewBox="0 0 24 24" fill="none"><path fill="var(--brand2)" d="M21.6 5.6a1 1 0 0 0-1.1-.1L3.5 12.9a.9.9 0 0 0 .1 1.7l4.4 1.4 1.7 5a1 1 0 0 0 1.7.4l2.3-2.3 4.5 3.2a1 1 0 0 0 1.6-.6l2.8-14.5a1 1 0 0 0-.4-1zM9.6 15l8.6-7-10.6 6 2 1z"/></svg>
          </a>
        </div>
        Присоединяйтесь к&nbsp;нам: <a href="https://lekomIT.t.me" target="_blank">@LekomIT</a>
      </div>
    </div>

    <!-- экран аудита -->
    <div id="screen-audit" class="card section" style="display:none">
      <h1>
        Аудит печатной инфраструктуры
        <span class="muted" style="display:block;font-size:14px;font-weight:500;margin-top:6px;">Неудобные вопросы, которые нужно задать самим себе</span>
      </h1>
      <div id="auditProgress" class="muted">Ответы: 0 / 11</div>

      <form id="auditForm"></form>

      <div class="section">
        <button id="btnAuditResult" class="btn btn-primary">
          <span>Посмотреть результат</span>
          <span class="btn-sub" id="btnAuditSub">(ответов 0 из 11)</span>
        </button>
      </div>

      <div id="resultBox" class="section" style="display:block">
  <div class="result-card" id="resultCard">
    <div class="result-score" id="resultText">
      Ответьте на вопросы и&nbsp;нажмите кнопку выше.
    </div>
    <div class="result-hint">
      Это быстрая оценка.<br>
      Для детального аудита — оставьте контакт или&nbsp;обсудите с экспертом.
    </div>
    <div class="cta-row">
      <button id="ctaExpert" class="btn btn-secondary">💬 Обсудить с экспертом</button>
      <button id="toggleLead" class="btn btn-secondary">📩 Оставить контакты</button>
    </div>
    <div id="leadForm" style="display:none; margin-top:10px">
      <input id="leadName"    type="text" placeholder="Ваше имя" style="margin-top:8px" />
      <input id="leadCompany" type="text" placeholder="Компания" style="margin-top:8px" />
      <input id="leadPhone"   type="text" placeholder="Телефон или email" style="margin-top:8px" />
      <button id="sendLead" class="btn btn-primary" style="margin-top:10px">Отправить</button>
      <div class="muted" style="margin-top:8px;text-align:center;">
        Отправляя данные, вы соглашаетесь с <a href="https://lekom.ru/politika-konfidencialnosti/" target="_blank">политикой конфиденциальности</a>.
      </div>
    </div>
  </div>
</div>
      </div>

      <div class="section">
        <button id="backStart1" class="btn btn-secondary" style="flex-direction:row">
          <svg viewBox="0 0 24 24" fill="none"><path d="M12 5a7 7 0 1 1-6.32 4H3m0 0 3-3m-3 3 3 3" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/></svg>
          Вернуться
        </button>
      </div>
    </div>

    <!-- экран вебинара -->
    <div id="screen-poll" class="card section" style="display:none">
      <h1>Выбор темы вебинара</h1>
      <form id="pollForm" class="section">
        <div class="pill" data-topic="Обзор рынка и тренды 2025">Обзор рынка и тренды 2025</div>
        <div class="pill" data-topic="Закупки по 44-ФЗ / 223-ФЗ">Закупки по 44-ФЗ / 223-ФЗ</div>
        <div class="pill" data-topic="Импортозамещение (техника, софт, расходники)">Импортозамещение (техника, софт, расходники)</div>
        <div class="pill" data-topic="Рынок картриджей — есть ли жизнь после OEM?">Рынок картриджей — есть ли жизнь после OEM?</div>
        <div class="q" style="margin-top:14px">
          <b>Другая тема</b>
          <input id="pollOther" type="text" placeholder="Предложите свою тему" />
        </div>
      </form>
      <div class="section">
        <button id="sendPoll" class="btn btn-primary">Отправить выбор</button>
      </div>

      <div class="section">
        <button id="backStart2" class="btn btn-secondary" style="flex-direction:row">
          <svg viewBox="0 0 24 24" fill="none"><path d="M12 5a7 7 0 1 1-6.32 4H3m0 0 3-3m-3 3 3 3" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/></svg>
          Вернуться
        </button>
      </div>
    </div>
  </div>

  <!-- JS: переключение темы + логотипы -->
  <script>
    (function(){
      const btn = document.getElementById('themeToggle');
      const iconMoon = document.getElementById('iconMoon');
      const iconSun  = document.getElementById('iconSun');
      const label = document.getElementById('themeLabel');
      const logoDark  = document.getElementById('logoDark');
      const logoLight = document.getElementById('logoLight');

      function apply(theme){
        const isLight = theme === 'light';
        document.documentElement.classList.toggle('theme-light', isLight);
        document.documentElement.setAttribute('data-theme', theme);
        iconMoon.style.display = isLight ? 'none' : '';
        iconSun.style.display  = isLight ? '' : 'none';
        label.textContent = isLight ? 'Светлая' : 'Тёмная';
        logoDark.style.display  = isLight ? 'none'  : 'block';
        logoLight.style.display = isLight ? 'block' : 'none';
      }

      btn?.addEventListener('click', ()=>{
        const current = document.documentElement.getAttribute('data-theme') || 'dark';
        const next = current === 'dark' ? 'light' : 'dark';
        localStorage.setItem('theme', next);
        apply(next);
      });

      apply(document.documentElement.getAttribute('data-theme') || 'dark');
    })();
  </script>

  <!-- Основная логика приложения -->
  <script src="app.js?v=logo-github-1"></script>
</body>
</html>
