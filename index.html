<!doctype html>
<html lang="ru">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover" />
  <title>ЛЕКОМ · Мини-апп</title>

  <!-- Ранняя установка темы -->
  <script>
    (function () {
      const saved = localStorage.getItem('theme');
      const prefersLight = window.matchMedia('(prefers-color-scheme: light)').matches;
      const theme = saved || (prefersLight ? 'light' : 'dark');
      if (theme === 'light') document.documentElement.classList.add('theme-light');
      document.documentElement.setAttribute('data-theme', theme);
    })();
  </script>

  <script>
    window.LEKOM_HOOK = 'https://script.google.com/macros/s/AKfycbzUnezeA6Pu2-ol6UVUkZpqfBIpEyji09dMGbkk6m4-Iu2-3-KwxZkLTrkoHGHRcIqN/exec';
  </script>

  <style>
  @import url('https://fonts.googleapis.com/css2?family=Roboto:wght@400;500;700&display=swap');

  :root {
    --bg:#0e1015; --bg2:#171b25; --stroke:#293044;
    --text:#eaf0fa; --text-dim:#96a2c2;
    --brand:#2a7de1; --brand2:#1db8aa;
    --radius:16px; --shadow:0 10px 30px rgba(0,0,0,.25);
    --res-bg:#0f1623; --res-stroke:#22314d; --bar-bg:#101625;
  }
  html.theme-light {
    --bg:#f6f8fb; --bg2:#ffffff; --stroke:#e2e8f0;
    --text:#0f172a; --text-dim:#4b5563;
    --brand:#2a7de1; --brand2:#10b3a3;
    --shadow:0 8px 24px rgba(15,23,42,.08);
    --res-bg:#ffffff; --res-stroke:#d7e0ef; --bar-bg:#edf2f7;
  }

  html,body {
    margin:0; padding:0;
    background:var(--bg); color:var(--text);
    font-family:Roboto,sans-serif;
    -webkit-font-smoothing:antialiased;
  }
  .app { max-width:720px; margin:0 auto; padding:20px 16px 28px; }

  /* Шапка */
  .topbar { display:flex; align-items:center; justify-content:space-between; margin-bottom:16px; }
  .logo { height:28px; display:none; }
  .logo-dark { display:inline; }
  html.theme-light .logo-dark { display:none; }
  html.theme-light .logo-light { display:inline; }

  /* Кнопки */
  .btn {
    display:inline-flex; align-items:center; justify-content:center;
    width:100%; padding:14px 16px; min-height:50px;
    font-size:16px; font-weight:700;
    border-radius:12px; border:1px solid transparent;
    cursor:pointer; transition:filter .12s,transform .06s;
    text-align:center; flex-direction:column;
  }
  .btn:active { transform:translateY(1px); }
  .btn-primary { background:linear-gradient(135deg,var(--brand),var(--brand2)); color:#fff; }
  .btn-secondary { background:var(--bg2); color:var(--text); border:1px solid var(--stroke); }
  .btn-sub { font-size:13px; font-weight:600; opacity:.95; margin-top:3px; }

  .card {
    background:var(--bg2); border:1px solid var(--stroke);
    border-radius:var(--radius); padding:20px; box-shadow:var(--shadow);
  }
  h1{font-size:26px;margin:0 0 10px;}
  h2{font-size:22px;margin:0 0 10px;}
  h3{font-size:18px;margin:0 0 8px;}
  .muted{color:var(--text-dim);}
  hr{border:0;height:1px;background:var(--stroke);opacity:.6;margin:16px 0;}

  .pill {
    display:block; margin-top:8px; padding:14px 16px;
    border-radius:12px; border:1px solid var(--stroke);
    background:var(--bg2); color:var(--text);
    text-align:left; cursor:pointer;
  }
  .pill.selected {
    background:rgba(29,184,170,.22);
    border-color:var(--brand2);
    outline:2px solid rgba(29,184,170,.45);
  }

  /* Результаты */
  .result-card {
    background:var(--res-bg); border:1px solid var(--res-stroke);
    border-radius:16px; padding:16px; margin-top:16px;
  }
  .result-score { font-size:22px; font-weight:800; text-align:center; margin-bottom:6px; }
  .result-verdict { font-size:18px; font-weight:700; text-align:center; margin-top:6px; }
  .result-advice { text-align:center; margin-top:8px; color:var(--text-dim); }

  /* Кнопка Вернуться */
  .footer-actions { margin-top:auto; text-align:center; }
  .back-btn {
    display:inline-flex; align-items:center; gap:6px;
    width:auto; padding:10px 18px;
    border-radius:10px; font-size:15px; font-weight:600;
  }
  .icon-back { width:16px; height:16px; }

  /* Футер */
  .global-footer {
    margin-top:24px; padding-top:12px;
    border-top:1px solid var(--stroke);
    text-align:center; font-size:14px; color:var(--text-dim);
  }
  .footer-icons { display:flex; justify-content:center; gap:14px; margin-bottom:6px; }
  .footer-icons svg { width:22px; height:22px; }
  .global-footer a { color:var(--brand2); text-decoration:none; }
  .global-footer a:hover { text-decoration:underline; }
  </style>
</head>
<body>
  <div class="app">

    <!-- Шапка -->
    <div class="topbar">
      <img src="img/logo-dark.png" alt="ЛЕКОМ" class="logo logo-dark" />
      <img src="img/logo-light.png" alt="ЛЕКОМ" class="logo logo-light" />
    </div>

    <!-- Стартовый экран -->
    <div id="screen-start" class="card">
      <div class="btn-row">
        <button id="goAudit" class="btn btn-primary">
          Пройдите быстрый аудит печати
          <span class="btn-sub">выявите слабые места в&nbsp;управлении печатной инфраструктурой</span>
        </button>
        <button id="goPoll" class="btn btn-secondary">Выберите тему вебинара</button>
      </div>

      <hr>
      <h3>Сводка голосования по темам</h3>
      <div id="summaryContent"><div class="muted">Загрузка…</div></div>
    </div>

    <!-- Аудит -->
    <div id="screen-audit" class="card" style="display:none">
      <h1>Аудит печатной инфраструктуры</h1>
      <p class="muted" style="margin-top:-8px;">Неудобные вопросы, которые нужно задать самим себе</p>
      <div id="auditProgress" class="muted">Ответы: 0 / 11</div>

      <form id="auditForm">
        <div class="q">
          <b>1. Как вы оцениваете прозрачность учета расходов на печать?</b>
          <div class="pill" data-q="q1" data-score="1">Мы ведем точный учет всех расходов, включая капитальные.</div>
          <div class="pill" data-q="q1" data-score="0">Только расходные материалы.</div>
          <div class="pill" data-q="q1" data-score="0">Частично или нерегулярно.</div>
          <div class="pill" data-q="q1" data-score="0">Нет точных данных.</div>
        </div>
      </form>

      <div>
        <button id="btnAuditResult" class="btn btn-primary">
          Посмотреть результат
          <span class="btn-sub" id="btnAuditSub">(ответов 0 из 11)</span>
        </button>

        <div class="result-card">
          <div id="resultText" class="result-score">Ответьте на вопросы&nbsp;и нажмите кнопку выше.</div>
          <div id="resultVerdict" class="result-verdict" style="display:none"></div>
          <div id="resultAdvice" class="result-advice" style="display:none"></div>
          <div class="result-advice">Предварительный анализ.<br>Для детального аудита — оставьте контакт или&nbsp;обсудите с экспертом.</div>
        </div>
      </div>

      <div class="footer-actions">
        <button id="backFromAudit" class="btn btn-secondary back-btn">
          <svg class="icon-back" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"
               stroke-linecap="round" stroke-linejoin="round">
            <polyline points="15 18 9 12 15 6"></polyline>
            <line x1="9" y1="12" x2="21" y2="12"></line>
          </svg>
          Вернуться
        </button>
      </div>
    </div>

    <!-- Вебинары -->
    <div id="screen-poll" class="card" style="display:none">
      <h1>Выбор темы вебинара</h1>
      <div class="q">
        <div class="pill poll-opt" data-topic="Обзор рынка и тренды 2025">Обзор рынка и тренды 2025</div>
        <div class="pill poll-opt" data-topic="Закупки по 44-ФЗ / 223-ФЗ">Закупки по 44-ФЗ / 223-ФЗ</div>
        <div class="pill poll-opt" data-topic="Импортозамещение">Импортозамещение (техника, софт, расходники)</div>
        <div class="pill poll-opt" data-topic="Рынок картриджей">Рынок картриджей — есть ли жизнь после OEM?</div>
        <div class="pill poll-opt" data-topic="Другая тема">Другая тема</div>
        <div id="pollOtherBox" style="display:none;margin-top:10px">
          <textarea id="pollOther" rows="4" placeholder="Предложите свою тему — нам важно ваше мнение"></textarea>
        </div>
      </div>
      <button id="sendPoll" class="btn btn-primary">Проголосовать</button>

      <div class="footer-actions">
        <button id="backFromPoll" class="btn btn-secondary back-btn">
          <svg class="icon-back" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"
               stroke-linecap="round" stroke-linejoin="round">
            <polyline points="15 18 9 12 15 6"></polyline>
            <line x1="9" y1="12" x2="21" y2="12"></line>
          </svg>
          Вернуться
        </button>
      </div>
    </div>

    <!-- Футер -->
    <div class="global-footer">
      <div class="footer-icons">
        <a href="https://lekomIT.t.me" target="_blank" title="Telegram">
          <svg viewBox="0 0 24 24" fill="none"><path fill="var(--brand2)" d="M21.6 5.6a1 1 0 0 0-1.1-.1L3.5 12.9a.9.9 0 0 0 .1 1.7l4.4 1.4 1.7 5a1 1 0 0 0 1.7.4l2.3-2.3 4.5 3.2a1 1 0 0 0 1.6-.6l2.8-14.5a1 1 0 0 0-.4-1zM9.6 15l8.6-7-10.6 6 2 1z"/></svg>
        </a>
        <a href="https://www.youtube.com/@lekomIT" target="_blank" title="YouTube">
          <svg viewBox="0 0 24 24">
            <path style="fill:transparent;stroke:var(--brand2);stroke-width:1.2" d="M3.2 8.3c.2-.9.9-1.6 1.8-1.8C7.8 6.2 12 6.2 12 6.2s4.2 0 7 .3c.9.2 1.6.9 1.8 1.8.3 1.9.3 3.7.3 3.7s0 1.8-.3 3.7c-.2.9-.9 1.6-1.8 1.8-2.8.3-7 .3-7 .3s-4.2 0-7-.3a2.2 2.2 0 0 1-1.8-1.8C3 13.8 3 12 3 12s0-1.8.2-3.7Z"/>
            <path style="fill:var(--brand2)" d="M10 15V9l5 3-5 3z"/>
          </svg>
        </a>
      </div>
      Присоединяйтесь к нам: <a href="https://lekomIT.t.me" target="_blank">@LekomIT</a>
    </div>
  </div>

  <script defer src="/app.js"></script>
</body>
</html>
